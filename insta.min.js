insta={ds_user_id:document.cookie.split("ds_user_id=")[1].split(";")[0],cnt:100,mutual:!0,qhash:{followings:{hash:"d04b0a864b4b54837c0d870b0e77e076",edge:"edge_follow",text:"followings"},followers:{hash:"c76146de99bb02f6415203be841dd25a",edge:"edge_followed_by",text:"followers"}},addr:function(){return`https://www.instagram.com/graphql/query/?query_hash={q}&variables={"id":"${insta.ds_user_id}","include_reel":"true","fetch_mutual":"${insta.mutual}","first":"${insta.cnt}","after":"{after}"}`},getList:async function(e,t,n){if(t.count==t.edges.length)return;let o=insta.addr().replace(/{q}/,e.hash).replace(/{after}/,t.cursor);await fetch(o).then(e=>e.json()).then(async o=>{console.log("d",o),t.count=o.data.user[e.edge].count,o.data.user[e.edge].edges.forEach(e=>{t.edges.push(e)}),document.getElementById("alinsta_p").innerHTML+=`<div>fetch ${e.text} ${Math.round(t.edges.length/t.count*100)}%</div><br/>`,o.data.user[e.edge].page_info.has_next_page?(t.cursor=o.data.user[e.edge].page_info.end_cursor,await n()):(t.cursor="",console.log("obj",t))}).catch(e=>{console.error(e)})},followings:{count:-1,edges:[],cursor:""},getFollowings:async function(){await insta.getList(insta.qhash.followings,insta.followings,insta.getFollowings)},followers:{count:-1,edges:[],cursor:""},getFollowers:async function(){await insta.getList(insta.qhash.followers,insta.followers,insta.getFollowers)},getDiff:async function(){insta.render(),await insta.getFollowers(),await insta.getFollowings(),document.getElementById("alinsta_p").remove(),insta.renderResult([],"choose action")},render:function(){let e=document.createElement("div");e.id="alinsta",e.style="width: 400px; /*! height: 400px; */ margin: 10px; top: 10px; position: absolute; left: 10px; background-color: rgb(200, 200, 200); border: 1px solid black; opacity: 0.98; display: flex;bottom: 10px;",document.body.appendChild(e);let t=document.createElement("div");t.id="alinsta_h",t.innerHTML="following diff finder",t.style="text-align: center;padding: 3px;font-weight: bold;",e.appendChild(t);let n=document.createElement("div");n.style="display: flex;flex-direction: row;",e.appendChild(n);let o=document.createElement("button");o.innerText="Close",o.onclick=(()=>{document.getElementById("alinsta").remove()}),n.appendChild(o);let l=document.createElement("button");l.innerText="only you follow",l.onclick=(()=>{const e=insta.followings.edges.filter(e=>null==insta.followers.edges.find(t=>t.node.id==e.node.id));insta.renderResult(e,l.innerText)}),n.appendChild(l);let i=document.createElement("button");i.innerText="only they follow",i.onclick=(()=>{const e=insta.followers.edges.filter(e=>null==insta.followings.edges.find(t=>t.node.id==e.node.id));insta.renderResult(e,i.innerText)}),n.appendChild(i);let a=document.createElement("div");a.id="alinsta_i",a.style="overflow: auto;position: relative;max-height: 100%;flex-shrink: 1;background-color: whitesmoke;",e.appendChild(a);let s=document.createElement("div");s.id="alinsta_p",a.appendChild(s)},renderResult:function(e,t){document.getElementById("alinsta_h").innerHTML=t+`; count=${e.length}`,document.getElementById("alinsta_i").innerHTML="",e.forEach(e=>{let t=document.createElement("div");t.style="flex-direction: row; margin: 2px;",t.innerHTML=`<a style="display: flex;" href="http://www.instagram.com/${e.node.username}"><img style="width:50px;height:50px" src="${e.node.profile_pic_url}"/><span>${e.node.username}</span></a>`,document.getElementById("alinsta_i").appendChild(t)})}},insta.getDiff();